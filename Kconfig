# This file is part of vermillion.

# Vermillion is free software: you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published
# by the Free Software Foundation, version 3.

# Vermillion is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with vermillion. If not, see <https://www.gnu.org/licenses/>.

# Architecture configuration

menu "General setup"

config STACK_SIZE
    hex "Kernel stack size"
    default 0x8000

choice ARCH
    prompt "Architecture"
config ARCH_ARM
    bool "ARM"
config ARCH_I686
    bool "i686"
endchoice

menu "Architecture options"
source arch/arm/Kconfig
endmenu

menu "Compilation"
config ARCH
    string "Arch name"
    default arm if ARCH_ARM
    default i686 if ARCH_I686
config TARGET
    string "Target triple"
    default arm-none-eabi if ARCH_ARM
    default i686-elf      if ARCH_I686
config CFLAGS
    string "Additional CFLAGS"
    default "-fpic -mcpu=cortex-a7 -mfloat-abi=soft -Wl,--no-warn-rwx-segment"\
            if ARCH_ARM
endmenu

menu "FDPIC Loader"
config LOADER_FILE
    string "Init file path"
    default "init.bin"
config LOADER_EMBED
    bool "Embed init into kernel"
    default n
endmenu

menu "General purpose RAM"
config RAM_ADDRESS
    hex "Mapped address"
    default 0x40000000 if ARCH_ARM
    default 0x100000   if ARCH_I686
config RAM_SIZE
    hex "Full length"
    default 0x20000000
endmenu

config LED_SUCCESS
    bool
    default y
menuconfig LED_SUCCESS
    prompt "Board LED (Success)"
config LED_SUCCESS_PIN
    int "Pin"
    default 202
    depends on LED_SUCCESS
config LED_FAILURE
    bool
    default y
menuconfig LED_FAILURE
    prompt "Board LED (Failure)"
config LED_FAILURE_PIN
    int "Pin"
    default 15
    depends on LED_FAILURE

endmenu

# Driver configuration

menu "Device drivers"

# Architecture drivers

menu "Architecture"

config ARM_GIC
    bool
menuconfig ARM_GIC
    prompt "Generic Interrupt Controller"
    default y if ARCH_ARM
    depends on ARCH_ARM
config GIC_CPU
    hex "CPU address"
    default 0x01C82000
    depends on ARM_GIC
config GIC_DIST
    hex "DIST address"
    default 0x01C81000
    depends on ARM_GIC
choice GIC_TYPE
    prompt "Interrupt Type"
    default GIC_TYPE_2
    depends on ARM_GIC
config GIC_TYPE_0
    bool "Low level"
config GIC_TYPE_1
    bool "High level"
config GIC_TYPE_2
    bool "Low edge"
config GIC_TYPE_3
    bool "High edge"
endchoice

endmenu

# Video configuration

menu "Video Output"
config VIDEO_ILI9488_SPI
    bool
menuconfig VIDEO_ILI9488_SPI
    prompt "Ili9488 (SPI)"
config ILI9488_DCRS
    int "DCRS pin"
    default 12
    depends on VIDEO_ILI9488_SPI
config ILI9488_LEDS
    int "LEDS pin"
    default 11
    depends on VIDEO_ILI9488_SPI
endmenu

# Audio configuration

menu "Audio Output"
config AUDIO_BUZZER
    bool
menuconfig AUDIO_BUZZER
    prompt "Buzzer"
config BUZZER_PIN
    int "Output pin"
    default 13
    depends on AUDIO_BUZZER
endmenu

# Storage configuration

menu "Storage"
config STORAGE_SUNXI_MMC
    bool "Sunxi SD/MMC"
    depends on ARCH_ARM
endmenu

# Filesystem configuration

menu "Filesystem"
config FS_FAT32_MBR
    bool "Fat32 MBR"
endmenu

# Serial configuration

menu "Serial"
config SERIAL_SUNXI_UART
    bool "Sunxi UART"
    depends on ARCH_ARM
config SERIAL_I686
    bool "x86 serial ports"
    default y if ARCH_I686
    depends on ARCH_I686
endmenu

# Timer configuration

menu "Timer"
config TIMER_SUNXI_TIMER
    bool
menuconfig TIMER_SUNXI_TIMER
    prompt "Sunxi Timer"
    depends on ARCH_ARM
config SUNXI_TIMER0_IRQ
    int "Timer0 IRQ"
    default 50
    depends on TIMER_SUNXI_TIMER
config SUNXI_TIMER1_IRQ
    int "Timer1 IRQ"
    default 51
    depends on TIMER_SUNXI_TIMER
endmenu

# SPI configuration

menu "SPI"
config SPI_BITBANG
    bool
menuconfig SPI_BITBANG
    prompt "Bitbang"
config BITBANG_SPI_SS
    int "SS pin"
    default 0
    depends on SPI_BITBANG
config BITBANG_SPI_SCK
    int "SCK pin"
    default 1
    depends on SPI_BITBANG
config BITBANG_SPI_MOSI
    int "MOSI pin"
    default 2
    depends on SPI_BITBANG
config BITBANG_SPI_MISO
    int "MISO pin"
    default 3
    depends on SPI_BITBANG
endmenu

# GPIO configuration

menu "GPIO"
config GPIO_SUNXI_GPIO
    bool "Sunxi GPIO"
    depends on ARCH_ARM
endmenu

endmenu
